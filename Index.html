<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Log√≠stica</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <style>
    :root {
      --color-bg: #f8f9fa;
      --color-text: #212529;
      --color-header: #0d6efd;
      --color-th-bg: #0d6efd;
      --color-th-text: #ffffff;
      --color-row-alt-bg: #e9ecef;
      --color-row-alt-text: #212529;
      --font-size: 16px;
    }
    body.dark {
      --color-bg: #121416;
      --color-text: #e4e6eb;
      --color-header: #1c1f22;
      --color-th-bg: #2a2f34;
      --color-th-text: #f1f1f1;
      --color-row-alt-bg: #2f3439;
      --color-row-alt-text: #ffffff;
    }
    body {
      background-color: var(--color-bg);
      color: var(--color-text);
      margin: 0;
      padding: 1rem;      /* Evita recorte en Smart TV */
      box-sizing: border-box;
      zoom: 0.9;          /* Reduce ligeramente el tama√±o */
      height: 100vh;
      display: flex;
      flex-direction: column;
      transition: background-color 0.4s, color 0.4s;
      font-size: var(--font-size);
      font-family: "Segoe UI", sans-serif;
    }
    header {
      background-color: var(--color-header);
      color: white;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      transition: background-color 0.4s;
    }
    main {
      flex: 1;
      overflow: auto;
      padding: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      text-align: left;
      background-color: var(--color-bg);
      transition: background-color 0.4s, color 0.4s;
    }
    th {
      position: sticky;
      top: 0;
      background-color: var(--color-th-bg);
      color: var(--color-th-text);
      padding: 0.7rem;
      border-bottom: 2px solid #0d6efd55;
      transition: background-color 0.4s, color 0.4s;
    }
    td {
      padding: 0.6rem;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      transition: background-color 0.4s, color 0.4s;
    }
    tr:nth-child(even) td {
      background-color: var(--color-row-alt-bg);
      color: var(--color-row-alt-text);
    }
    tr:nth-child(odd) td {
      background-color: var(--color-bg);
      color: var(--color-text);
    }
    .btn-toggle, .btn-font {
      background-color: white;
      color: #0d6efd;
      border: none;
      border-radius: 6px;
      padding: 0.4rem 0.8rem;
      cursor: pointer;
      font-weight: 500;
      margin-left: 0.5rem;
      transition: background-color 0.3s, color 0.3s;
    }
    body.dark .btn-toggle, body.dark .btn-font {
      background-color: #2b3035;
      color: #f1f1f1;
    }
    .table-container {
      max-width: 100%;
      height: calc(100vh - 120px);
      overflow: auto;
    }
    .controls {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
  </style>
</head>
<body>
  <header>
    <h3>üìä Dashboard Log√≠stica</h3>
    <div class="controls">
      <button class="btn-font" id="fontMinus">A‚àí</button>
      <button class="btn-font" id="fontPlus">A+</button>
      <button class="btn-toggle" id="modoBtn">üåô Modo oscuro</button>
    </div>
  </header>

  <main class="container-fluid">
    <div class="table-container">
      <table class="table table-hover table-bordered" id="tabla">
        <thead id="encabezado"></thead>
        <tbody id="contenido"></tbody>
      </table>
    </div>
  </main>

  <script>
    // üß© Reemplaza esta URL por la de tu Apps Script (termina con /exec)
    const baseUrl = "https://script.google.com/macros/s/AKfycbwIDklElQCDusfjLdlKyQA2NSPzTHuNKgGKEiG1hmikI6Bhzd8p_q-Abc5NwhFve_gQ/exec";

    async function cargarDatos() {
      try {
        const url = baseUrl + "?t=" + Date.now(); // evita cach√©
        const resp = await fetch(url, { cache: "no-store" });
        if (!resp.ok) throw new Error("No se pudo acceder a los datos");
        const texto = await resp.text();
        const data = Papa.parse(texto, { header: true, skipEmptyLines: true }).data;
        mostrarTabla(data);
      } catch (error) {
        console.error("Error al cargar datos:", error);
      }
    }

    function mostrarTabla(data) {
      if (!data.length) return;
      const encabezados = Object.keys(data[0]);
      const ths = encabezados.map(h => `<th>${h}</th>`).join("");
      document.getElementById("encabezado").innerHTML = `<tr>${ths}</tr>`;
      document.getElementById("contenido").innerHTML = data.map(fila =>
        `<tr>${encabezados.map(c => `<td>${fila[c] || ""}</td>`).join("")}</tr>`
      ).join("");
    }

    // üåô Modo oscuro
    const btnModo = document.getElementById("modoBtn");
    btnModo.addEventListener("click", () => {
      document.body.classList.toggle("dark");
      btnModo.textContent = document.body.classList.contains("dark")
        ? "‚òÄÔ∏è Modo claro"
        : "üåô Modo oscuro";
    });

    // üî† Control de tama√±o de fuente
    const btnMas = document.getElementById("fontPlus");
    const btnMenos = document.getElementById("fontMinus");
    btnMas.addEventListener("click", () => cambiarTama√±oFuente(1));
    btnMenos.addEventListener("click", () => cambiarTama√±oFuente(-1));

    function cambiarTama√±oFuente(delta) {
      const current = parseFloat(getComputedStyle(document.body).fontSize);
      const nuevo = Math.max(12, Math.min(24, current + delta));
      document.body.style.fontSize = nuevo + "px";
    }

    // üîÅ Cargar al inicio y actualizar cada 5 segundos
    cargarDatos();
    setInterval(cargarDatos, 5000);
  </script>
</body>
</html>
